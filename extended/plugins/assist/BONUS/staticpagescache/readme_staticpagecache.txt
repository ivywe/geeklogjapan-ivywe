 --------------------------------------------------------------------------------
 staticpagecache
 2012/12/06
 lastupdate 2013/07/31
 --------------------------------------------------------------------------------
 機能 ：静的ページのキャッシュファイルを作成します
 -------------------------------------------------------------------------------
 ファイル構成例
 GEEKLOG
   ├ job
   │ ├ staticpagecache.php  (シェルプログラムから実行するPHPプログラム例1）
   │ │　　注：ディレクトリの記述の確認修正が必要
   │ │　　引数１：静的ページid
   │ │　　引数２：当プログラムでは使用しません。
   │ │　　　　 引数2の使用例
   │ │　　　　 [assist:staticpage_content id:xxxx urlkey:yyyy]
   │ │　　　　 を使用している場合
   │ │　　　　 yyyy が静的ページid ではヒットしない場合引数2にyyyy を
   │ │　　　　 記述します
   │ │ 
   │ ├ staticpagecache　  (CRONに記述するシェルプログラム例1）　
   │ │　　注：ディレクトリの記述の確認修正が必要
   │ │　　注：debian系サーバの場合　
   │ │　　　　ドットを含まないディレクトリに、ドットを含まないファイル名に
   │ │　　注：実行可能なパーミッション(755)になっていることの確認が必要
   │ │
   ├ system
   │ ├ custom
   │    ├ custom_switchlang.php 
   │    │　　コマンドで実行されたプログラム用の言語変更
   │    │　　lib_custom.php に
   │    │　　require_once( 'custom/custom_switchlang.php' );
   │    │　　を追記して使用してください
   │    │　　
   ├ public_html
   │    ├ admin 　　
   │       ├ plugins 　　
   │          ├ assist 　　
   │            ├ makecache.php 　(WEBから実行するプログラム例１)
   │    　
   ├ [assist プラグインの コンフィギュレーション設定 キャッシュファイルパス]
   │    ├ staticpages 
   │       │  注：パーミッション(777)になっていることの確認が必要
   │       ├ xxxx.html
 
CRONに記述するシェルプログラムは、CRON起動のルールの数だけ必要です。
CRON起動のルールが同じであれば、ひとつのCRONに記述するシェルプログラム
内に複数の静的ページのキャッシュ作成文を記述できます。

staticpagecache.php　makecache.php は　
assistプラグイン内のfnc_staticpagecache.inc を使用 します

キャッシュされるページ内容は、ゲストユーザが閲覧する表示内容になります。
下記の条件に該当しない場合はAccess Deniedの画面になる場合があります。
　1.ゲストユーザが閲覧できる
　2.下書ではない
　3.テンプレートではない。
　4.PHP静的ページではない
　5.話題: すべて
 
CRONTAB 記述例
00 03 * * * /path/to/geeklog/job/staticpagecache >/dev/null 2>&1

CRON実行時に発生するエラーと対応方法の例
　1.exit status 127 存在しない
　　directory が存在するか確認する
　2.exit status 126 実行できない
　　CRON実行プログラムのパーミッションを確認する
　3.exit status 255　正常終了しなかった
　　プログラムの内容を確認する（例えばディレクトリの変更が正しくないとか）

正常に動作しない場合のチェック項目
１）ディレクトリは、正しく変更されているか
２）[assist プラグインの コンフィギュレーション設定 キャッシュファイルパス]は正しいか
３）cacheファイルが書き込まれるディレクトリは書込可能(777)になっているか
４）シェルプログラムのパーミッションは、実行可能(755)になっているか
５）多言語モードの場合 system/custom/custom_switchlang.php を読み込むようにしてあるか


 