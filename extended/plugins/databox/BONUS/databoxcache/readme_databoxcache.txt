 --------------------------------------------------------------------------------
 databoxcache.php
 2013/07/19
 lastupdate 2013/08/06
 --------------------------------------------------------------------------------
 機能 ：DataBox 個別表示のキャッシュファイルを作成します
       Assist プラグイン（Version1.1.1以上）が有効である場合に機能します
 -------------------------------------------------------------------------------
 ファイル構成例
 GEEKLOG
   ├ job
   │ ├ databoxcache.php  (シェルプログラムから実行するPHPプログラム例1）
   │ │　　注：ディレクトリの記述の確認修正が必要
   │ │　　引数１：function:機能
   │ │　　　　　data:データ（ヘッダフッタなし）
   │ │　　　　　category:カテゴリ（ヘッダフッタなし））
   │ │　　　　　datapage:データページ（ヘッダフッタは、設定による）
   │ │　　　　　categorypage:カテゴリページ（ヘッダフッタは、設定による）
   │ │　　引数２：code:コード
   │ │　　引数３：template:テンプレートディレクトリ
   │ │ 
   │ │ 
   │ ├ databoxcache　  (CRONに記述するシェルプログラム例1）　
   │ │　　注：ディレクトリの記述の確認修正が必要
   │ │　　注：debian系サーバの場合　
   │ │　　　　ドットを含まないディレクトリに、ドットを含まないファイル名に
   │ │　　注：実行可能なパーミッション(755)になっていることの確認が必要
   │ │
   ├ public_html
   │    ├ admin 　　
   │       ├ plugins 　　
   │          ├ databox 　　
   │            ├ makecache.php 　(WEBから実行するプログラム例１)
   │    　
   ├ [assist プラグインの コンフィギュレーション設定 キャッシュファイルパス]
   │ ├ databox
   │ 	 ├ (コード)_THME_(テンプレートディレクトリ).html
   │ 	 ├ (コード).html
   

CRONに記述するシェルプログラムは、CRON起動のルールの数だけ必要です。
CRON起動のルールが同じであれば、ひとつのCRONに記述するシェルプログラム
内に複数の静的ページのキャッシュ作成文を記述できます。

databoxcache.php　makecache.php は　
databoxプラグイン内のfnc_databoxcache.inc を使用 します

キャッシュされるページ内容は、ゲストユーザが閲覧する表示内容になります。
下記の条件に該当しない場合はAccess Deniedの画面になる場合があります。
　1.ゲストユーザが閲覧できる
　2.下書ではない

 
 
CRONTAB 記述例
00 03 * * * /path/to/geeklog/job/databox >/dev/null 2>&1

CRON実行時に発生するエラーと対応方法の例
　1.exit status 127 存在しない
　　directory が存在するか確認する
　2.exit status 126 実行できない
　　CRON実行プログラムのパーミッションを確認する
　3.exit status 255　正常終了しなかった
　　プログラムの内容を確認する（例えばディレクトリの変更が正しくないとか）

プログラムファイル名は、サンプルです
変えてもらっても問題ありません

正常に動作しない場合のチェック項目
１）プログラムのディレクトリは、サーバーにあわせて、正しく変更されているか
２）[assist プラグインの コンフィギュレーション設定 キャッシュファイルパス]は正しいか
３）cache が書き込まれるディレクトリは書き込み可能になっているか
４）プログラムのパーミッションは、実行可能(755)になっているか
５）多言語モードの場合 system/custom/custom_switchlang.php を読み込むようにしてあるか



 