<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="ja">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <style type="text/css">
  <!--
    body {
    font-family: Helvetica, Arial, sans-serif;
    margin: 25px;
    }

    h1 {
    font-size: 1.5em;
    border-bottom: thin outset black;
    }

    h2 {
    margin: 0 0 0.5em 0;
    font-size: 1em;
    }

    h3 {
    border-bottom: 1px solid #0033FF;
    border-left: 6px solid #0033FF;
    padding: 0.25em;
    font-size: 1em;
    }

    h4 {
    font-size: 0.85em;
    font-weight: bold;
    margin: 0.2em 0;
    }

    p {
    font-size: 0.85em;
    margin: 0.5em 0;
    }

    .attention {
    color:#FF3300
    }

    ul {
    margin-top: 0.5em;
    margin-bottom: 1em;
    }

    li {
    font-size: 0.8em;
    margin: 0.5em 0;
    }

    li p {
    font-size: 0.8em;
    margin: 0.5em 0;
    }

    .email {
    padding-left: 1.3em;
    font-size: small;
    font-weight: normal;
    }

    pre {
    padding: 0.2em;
    border: 1px solid #BBBBBB;
    background-color: #EEEEEE;
    margin: 1em 1em 1em 3em;
    overflow: auto;
    font-size: 0.85em;
    line-height: 1.5em;
    }

    table {
    font-size: 0.8em;
    border: solid 1px black;
    border-collapse: collapse;
    }

    th,
    td
    {
    border: solid 1px black;
    padding: 5px;
    }

    span.comment {
    color: green;
    font-weight: bold;
    }

    .goto {
    margin: 1em 0 1.5em 0.5em;
    font-size: 0.8em;
    }

    .fix {
    color: red;
    font-weight: bold;
    }

    .new {
    color: blue;
    font-weight: bold;
    }

    .center {
    text-align: center;
    }

  -->
  </style>
  <title>Media Gallery Plugin for Geeklog - Installation</title>
</head>

<body>

<h1>Media Gallery for Geeklog - インストール</h1>


<p>メディアギャラリーは(詳しくドキュメント化されていませんが)Geeklogの一般的なプラグインのインストール方法と同様です。
以下にFTPとShellアクセスによる２通りでのインストール方法を紹介します。</p>

<h3>FTPでのインストール</h3>

<p>サーバーにShellアクセスできずFTPクライアントでのアクセスしか出来ない場合はこちらの手順でインストールしてください。</p>

<p>メディアギャラリーやGeeklogのプラグインをインストールするにはまず圧縮ファイルを解凍してください。
解凍すると自動的に適切なディレクトリに振り分けられファイルが作成されます。</p>

<p>.gzファイルの解凍にはWinZIPやWinRARが利用できます。</p>

<ol>
  <li>一時的なディレクトリを作成しメディアギャラリーのファイルを選択します。<br>(例: C:\tmp など)</li>
  <li>WinRARで mediagallery_1.7.0_2.0.0.tar.gz を開きます。</li>
  <li>解凍を選択し解凍先を C:\tmp にします。</li>
</ol>

<p>これでメディアギャラリーのファイルが C:\tmp に解凍されます。</p>

<p>フォルダの中は以下のようになっているはずです:</p>

<pre><code>+tmp\
    + mediagallery\
                  + admin\
                  + docs\
                  + include\
                  + language\
                  + public_html\
                  + sql\
                  + templates\
                  + tmp\
                  + uploads\
                  + autoinstall.php
                  + </code></pre>

<p>これでハードディスク上にファイルの複製ができました。あとはアップロードです。</p>

<p>FTPクライアントを起動します。おすすめはFileZillaですがインストール持ち合わせていなければ普段使っているものを使用してください。
FileZillaはフリーかつ多くのOSをサポートしています(Windows, Linux, など)。</p>

<p>FTPでウェブサーバーに接続します。</p>

<p>まずメディアギャラリーのファイルを漏れのないようにアップロードします。
以下の図に従って c:\tmp\mediagallery\ のファイルを path-to-geeklog/plugins/
の適切なディレクトリに配置します。</p>

<p>path-to-geeklogディレクトリはGeeklogのdb-configphpが存在するディレクトリです。</p>

<p><span style="font-weight: bold;">注意:</span> これは初期設定でのメディアギャラリーのアップロードの話です。
実際にはあなたの使用するサーバーでのプラグインディレクトリにmediagalleryフォルダごとアップロードしてください。
残りのファイルについても以下の通りアップロードしてください。</p>

<pre><code>tmp\                path-to-geeklog/
   |                               |
   + mediagallery\--+              + backups/
                    |              + data/
                    |              + language/
                    |              + logs/
                    +-------------&gt;+ plugins/
                                   + public_html/
                                   + sql/
                                   + system/
                                   + db-config.php</code></pre>

<p>次にpublic_htmlディレクトリにmediagalleryというサブディレクトリを作成します。
ほとんどのFTPクライアントでは親ディレクトリから作成できるようになっているのでpublic_htmlに作成する場合、
マウスを右クリックして「新しいフォルダ」から作成し名前をmediagalleryとしてください。
この手順とは少し異なる場合はお使いのFTPクライアントのドキュメントを確認してください。</p>

<pre><code>  path-to-geeklog/
                 |
                 + backups/
                 + data/
                 + language/
                 + logs/
                 + plugins/
                 + public_html/
                              |
                              + mediagallery &lt;--- Make this subdirectory
                 + sql/
                 + system/
                 + db-config.php</code></pre>

<p>次に c:\tmp\mediagallery\public_html\ フォルダにあるすべてのファイルをサーバーにアップロードします。
public_html\フォルダにあるファイルとフォルダをすべて選択し以下のようにアップロードしてください。
public_htmlフォルダではなくその中のファイルとフォルダですので間違わないようにしてください。</p>

<pre><code>tmp\                 path-to-geeklog/
   |                                |
   + mediagallery\                  + backups/
                 |                  + data/
                 + public_html\*-+  + language/
                                 |  + logs/
                                 |  + plugins/
                                 |  + public_html/
                                 |               |
                                 +--------------&gt;+ mediagallery/
                                    + sql/
                                    + system/
                                    + db-config.php</code></pre>

<p>次に admin/plugins/ に mediagallery というディレクトリを作成します。</p>

<pre><code>path-to-geeklog/
               |
               + backups/
               + data/
               + language/
               + logs/
               + plugins/
               + public_html/
               |    |
               |    + admin/
               |           |
               |           + plugins/
               |                    |
               |                    + mediagallery &lt;--- Make this subdirectory
               + sql/
               + system/
               + db-config.php</code></pre>

<p>次に c:\tmp\mediagallery\admin\ フォルダのファイルをアップロードします。
このadminフォルダの中のすべてのファイルとディレクトリを選択しアップロードしてください。
ここでもadminフォルダをそのままアップロードしないよう注意してください。</p>

<pre><code>tmp\            path-to-geeklog/
   |                           |
   + mediagallery\             + backups/
                 |             + data/
                 + admin\---+  + language/
                            |  + logs/
                            |  + plugins/
                            |  + public_html/
                            |         |
                            |         + admin/
                            |                |
                            |                + plugins/
                            |                         |
                            +-----------------------&gt; + mediagallery/
                               + sql/
                               + system/
                               + db-config.php</code></pre>

<p>おめでとうございます！ これですべてのファイルがサーバーにアップロードできました。
これ以降は「オンラインでのインストール」を参照してください。</p>

<h3>一般的なShellアクセスによるインストール</h3>

<ol>

  <li>メディアギャラリーではデータベースにテーブルを追加するのでデータベースをバックアップしてください。
Geeklogに組み込まれている管理者メニューにあるデータベースバックアップを利用するのが便利です。</li>

  <li>メディアギャラリーの圧縮ファイルを解凍し path-to-geeklog/pluginsディレクトリにコピーしてください。
解凍したときに mediagalleryディレクトリは既に作成されています。</li>

  <li>public_htmlディレクトリに mediagallery ディレクトリを作成します。</li>

  <li>public_html/admin/plugins/ にも mediagallery ディレクトリを作成します。</li>

  <li>カレントディレクトリを path-to-geeklog/plugins/mediagallery ディレクトリに移動します。</li>

  <li>admin ディレクトリにあるファイルをすべてステップ４で作成した admin/plugins/mediagallery へコピーします。</li>

  <li>public_html ディレクトリにあるファイルをすべてステップ３で作成した public_html/mediagallery へコピーします。</li>

</ol>

<h3>オンラインでのインストール</h3>

<p>これですべてのメディアギャラリーのファイルをサーバーにあるGeeklogの適切な場所にアップロードできていることでしょう。</p>

<ol start="1" type="1">

  <li>管理者ページのプラグインの項目を開いてください。
ここにメディアギャラリーをインストールするためのリンクが表示されているはずですのでこのリンクをクリックしてください。
インストールのページではメディアギャラリーをインストールできたかどうかを教えてくれます。
もし失敗となっている場合はGeeklogのpath-to-geeklog/logs/にあるerror.logを調べて問題点を解消または再アップロードしてください。</li>
  <li>利用状況に応じてメディアギャラリーの環境設定を変更してください。</li>

</ol>

<h3>パーミッションの設定</h3>
<p style="color:red">次のディレクトリのパーミッションを757（あるいは777）に設定する必要があります。</p>
<ul>
<li>private/plugins/mediagallery/tmp</li>
<li>private/plugins/mediagallery/uploads</li>
<li>public_html/mediagallery/mediaobjects/covers &nbsp;&nbsp;&nbsp;&nbsp;及び配下のディレクトリ</li>
<li>public_html/mediagallery/mediaobjects/disp   &nbsp;&nbsp;&nbsp;&nbsp;及び配下のディレクトリ</li>
<li>public_html/mediagallery/mediaobjects/orig   &nbsp;&nbsp;&nbsp;&nbsp;及び配下のディレクトリ</li>
<li>public_html/mediagallery/mediaobjects/tn     &nbsp;&nbsp;&nbsp;&nbsp;及び配下のディレクトリ</li>
</ul>

<h3>一般的なアップグレード方法</h3>

<ol>
  <li>既存の環境設定をバックアップしてください！</li>

  <li>あなたがテンプレートに加えた変更箇所がある場合そちらについてもバックアップしてください！
アップグレード後にそれらのカスタマイズを再度反映させる必要があります。</li>

  <li>インストールのための手順は新しいバージョンのメディアギャラリーの新規インストール手順の詳細を確認しながらサーバーにアップロードしてください。
既存のファイルを上書きするよう促された場合は「はい」を選択してください。</li>

  <li>Geeklogのプラグインメニューを開きます(Geeklogの管理者メニューから)。</li>

  <li>メディアギャラリープラグインを開きます。</li>

  <li>アップデートボタンが表示されているのでそちらをクリックします。</li>

  <li>ここまでの作業が問題なく完了するとアップグレードは完了です。
もし問題があった場合は logs/error.log を確認し、もう一度アップグレードを行ってください。</li>
</ol>

<h3>アップグレード後のチェック</h3>

<ul>

  <li>メディアギャラリーの設定をチェックしておきましょう。新機能についてはオンラインで確認してください。
以前のconfig.phpはそのまま使用することはできません。
メディアギャラリーの管理画面からシステム設定を必要に応じて変更してください。</li>

  <li>auto tagsの記述をチェックしておきましょう。以前のメディアギャラリーで使用されていた auto tags の使用方法に変更があります。</li>

  <li>メディアギャラリーのv0.8xまたはv0.9xからアップグレードする場合はサムネイルを再作成する必要があります。
メディアギャラリーでは大きな(200x200 ピクセル)サムネイルを備えています。
v0.8xやv0.9xでは150x150ピクセルでのサムネイルしかサポートされていませんでした。
メディアギャラリーの管理画面からサムネイル再作成を実行してください。</li>

</ul>

</body>
</html>
